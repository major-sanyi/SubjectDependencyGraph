@page "/admin"
@using SubjectDependencyGraph.Blazor.PageComponents.Admin
@using SubjectDependencyGraph.Shared.Models
@using SubjectDependencyGraph.Shared.Services
@inject ISyllabiService SyllabiService

<MudDivider />
<MudTabs Elevation="4" Rounded="true" Color="@Color.Secondary">
    <MudTabPanel Text="Syllabus">
        <SyllabusAdminComponent Syllabi="[..Syllabi]" />
    </MudTabPanel>
    <MudTabPanel Text="Spec">
        <MudStack Row>
            <MudSelect @bind-Value="SelectedSyllabus">
                @foreach (var item in Syllabi ?? [])
                {
                    <MudSelectItem Value="@item">@item</MudSelectItem>
                }
            </MudSelect>
        </MudStack>
        <SpecialisationAdminComponent ReadOnly=false Specs="[..SelectedSyllabus?.Specialisations]" />
    </MudTabPanel>
    <MudTabPanel Text="Subjects">
        <MudStack Row>
            <MudSelect @bind-Value="SelectedSyllabus">
                @foreach (var item in Syllabi ?? [])
                {
                    <MudSelectItem Value="@item">@item</MudSelectItem>
                }
            </MudSelect>
        </MudStack>
        <SubjectAdminComponent Subjects="SelectedSyllabus?.GetSubjectsWithSpecMarked()" />
    </MudTabPanel>
</MudTabs>
@code {
    public IEnumerable<Syllabus>? Syllabi { get; set; }
    public Syllabus? SelectedSyllabus { get; set; }

    protected override void OnInitialized()
    {
        Syllabi = SyllabiService.Syllabi.ToList();
        SelectedSyllabus = Syllabi.First();
        base.OnInitialized();
    }

}
